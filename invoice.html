<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shrestha International Couriers</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #1a252f;
            --accent-color: #ff6600;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --text-light: #7f8c8d;
            --border-color: #ddd;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 30px 0;
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            background-image: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo-img {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            object-fit: contain;
        }

        .logo-text h1 {
            font-size: 2rem;
            margin-bottom: 5px;
            color: white;
        }

        .logo-text p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .contact-info {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }

        .contact-item i {
            margin-right: 8px;
            color: var(--accent-color);
        }

        .owner-info {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
            font-size: 0.9rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .owner-info i {
            margin-right: 8px;
            color: var(--accent-color);
        }

        /* Form Styles */
        .tracking-form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            border-top: 4px solid var(--accent-color);
        }

        .tracking-form h2 {
            margin-bottom: 20px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
        }

        .tracking-form h2 i {
            margin-right: 10px;
            color: var(--accent-color);
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .form-group i {
            position: absolute;
            left: 12px;
            top: 40px;
            color: var(--text-light);
        }

        .btn {
            display: inline-block;
            background-color: var(--accent-color);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            background-color: #e05543;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn-primary {
            background-color: var(--primary-color);
        }

        .btn-danger {
            background-color: var(--danger-color);
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            position: relative;
            border-top: 4px solid var(--accent-color);
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: var(--accent-color);
        }

        /* Signature Pad */
        #signaturePad {
            border: 1px dashed #999;
            cursor: crosshair;
            width: 100%;
            height: 150px;
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }
            #printableArea, #printableArea * {
                visibility: visible;
            }
            #printableArea {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
            }
            .no-print {
                display: none !important;
            }
        }

        footer {
            text-align: center;
            padding: 20px 0;
            background-color: var(--dark-color);
            color: white;
            margin-top: 50px;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            .contact-info {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-container">
                    <img src="img/logo.png" alt="Shrestha International Couriers Logo" class="logo-img">
                    <div class="logo-text">
                        <h1>Shrestha International Couriers</h1>
                        <p>Fast & Reliable Logistics Solutions</p>
                    </div>
                </div>
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>srasthainternationalcouriers@gmail.com</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone-alt"></i>
                        <span>+91 94939 24742</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>7/4, Sali Pet, Arundelpet, Guntur, Andhra Pradesh 522002</span>
                    </div>
                </div>
                <div class="owner-info">
                    <i class="fas fa-user-tie"></i> Owner: Mr. Shrestha
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="tracking-form">
            <h2><i class="fas fa-file-invoice-dollar"></i> Invoice Generator</h2>
            <form id="invoiceForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="invoiceCustomerName">Customer Name</label>
                        <i class="fas fa-user"></i>
                        <input type="text" id="invoiceCustomerName" required>
                    </div>
                    <div class="form-group">
                        <label for="invoiceCustomerEmail">Customer Email</label>
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="invoiceCustomerEmail" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="invoiceCustomerAddress">Customer Address</label>
                        <i class="fas fa-map-marker-alt"></i>
                        <textarea id="invoiceCustomerAddress" rows="2" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="invoiceDate">Invoice Date</label>
                        <i class="fas fa-calendar-alt"></i>
                        <input type="date" id="invoiceDate" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="invoiceNumber">Invoice Number</label>
                        <i class="fas fa-hashtag"></i>
                        <input type="text" id="invoiceNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="invoiceTrackingNumber">Tracking Number</label>
                        <i class="fas fa-barcode"></i>
                        <input type="text" id="invoiceTrackingNumber" required>
                    </div>
                </div>
                
                <h3 style="margin: 20px 0 10px;"><i class="fas fa-boxes"></i> Items</h3>
                <div id="invoiceItems">
                    <div class="form-row invoice-item">
                        <div class="form-group" style="flex: 3;">
                            <label>Description</label>
                            <input type="text" class="item-description" required>
                        </div>
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" class="item-quantity" min="1" value="1" required>
                        </div>
                        <div class="form-group">
                            <label>Price (₹)</label>
                            <input type="number" class="item-price" min="0" step="0.01" required>
                        </div>
                        <div class="form-group" style="align-self: flex-end;">
                            <button type="button" class="btn btn-danger btn-sm remove-item">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <button type="button" id="addItemBtn" class="btn btn-sm" style="margin-bottom: 20px;">
                    <i class="fas fa-plus"></i> Add Item
                </button>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="invoiceNotes">Notes</label>
                        <textarea id="invoiceNotes" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="invoiceTerms">Terms & Conditions</label>
                        <textarea id="invoiceTerms" rows="2">Payment due within 15 days. Late fees may apply.</textarea>
                    </div>
                </div>
                
                <button type="submit" class="btn"><i class="fas fa-file-pdf"></i> Generate Invoice</button>
                <button type="button" id="previewInvoiceBtn" class="btn" style="margin-left: 10px;">
                    <i class="fas fa-eye"></i> Preview
                </button>
            </form>
        </section>

        <section class="tracking-form">
            <h2><i class="fas fa-file-signature"></i> Document Declaration Form</h2>
            <form id="declarationForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="declarationName">Full Name</label>
                        <i class="fas fa-user"></i>
                        <input type="text" id="declarationName" required>
                    </div>
                    <div class="form-group">
                        <label for="declarationEmail">Email</label>
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="declarationEmail" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="declarationPhone">Phone Number</label>
                        <i class="fas fa-phone"></i>
                        <input type="tel" id="declarationPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="declarationIdNumber">ID Number (Aadhaar/Passport)</label>
                        <i class="fas fa-id-card"></i>
                        <input type="text" id="declarationIdNumber" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="declarationAddress">Address</label>
                    <i class="fas fa-map-marker-alt"></i>
                    <textarea id="declarationAddress" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="declarationContent">Document/Content Description</label>
                    <i class="fas fa-file-alt"></i>
                    <textarea id="declarationContent" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="declarationValue">Declared Value (₹)</label>
                    <i class="fas fa-rupee-sign"></i>
                    <input type="number" id="declarationValue" min="0" required>
                </div>
                
                <div class="form-group">
                    <label>Signature</label>
                    <div style="border: 1px solid #ddd; padding: 10px; border-radius: 4px;">
                        <canvas id="signaturePad" width="100%" height="150"></canvas>
                        <div style="text-align: right; margin-top: 5px;">
                            <button type="button" id="clearSignatureBtn" class="btn btn-sm">
                                <i class="fas fa-eraser"></i> Clear
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <div style="display: flex; align-items: center;">
                        <input type="checkbox" id="declarationAgreement" required style="margin-right: 10px;">
                        <label for="declarationAgreement" style="margin-bottom: 0;">
                            I hereby declare that the information provided is true and correct to the best of my knowledge.
                        </label>
                    </div>
                </div>
                
                <button type="submit" class="btn"><i class="fas fa-check-circle"></i> Submit Declaration</button>
                <button type="button" id="saveDeclarationBtn" class="btn" style="margin-left: 10px;">
                    <i class="fas fa-save"></i> Save as PDF
                </button>
            </form>
        </section>
    </main>

    <!-- Invoice Preview Modal -->
    <div id="invoicePreviewModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2><i class="fas fa-file-invoice"></i> Invoice Preview</h2>
            <div id="printableArea">
                <!-- Invoice will be generated here -->
            </div>
            <div style="text-align: center; margin-top: 20px;" class="no-print">
                <button id="printInvoiceBtn" class="btn"><i class="fas fa-print"></i> Print Invoice</button>
                <button id="downloadInvoiceBtn" class="btn" style="margin-left: 10px;">
                    <i class="fas fa-download"></i> Download PDF
                </button>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2023 Shrestha International Couriers. All rights reserved.</p>
        </div>
    </footer>

    <!-- Required Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize invoice date with today's date
            document.getElementById('invoiceDate').valueAsDate = new Date();
            
            // Generate invoice number
            document.getElementById('invoiceNumber').value = 'INV-' + 
                new Date().getFullYear() + '-' + 
                (Math.floor(Math.random() * 9000) + 1000);
            
            // Add item button
            document.getElementById('addItemBtn').addEventListener('click', addInvoiceItem);
            
            // Remove item buttons
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('remove-item') || 
                    e.target.closest('.remove-item')) {
                    const item = e.target.closest('.invoice-item');
                    if (item && document.querySelectorAll('.invoice-item').length > 1) {
                        item.remove();
                    }
                }
            });
            
            // Preview invoice
            document.getElementById('previewInvoiceBtn').addEventListener('click', previewInvoice);
            
            // Print invoice
            document.getElementById('printInvoiceBtn').addEventListener('click', printInvoice);
            
            // Download invoice as PDF
            document.getElementById('downloadInvoiceBtn').addEventListener('click', downloadInvoice);
            
            // Form submission
            document.getElementById('invoiceForm').addEventListener('submit', function(e) {
                e.preventDefault();
                previewInvoice();
            });
            
            // Initialize signature pad
            const canvas = document.getElementById('signaturePad');
            const signaturePad = new SignaturePad(canvas, {
                backgroundColor: 'rgba(255, 255, 255, 0)',
                penColor: 'rgb(0, 0, 0)'
            });
            
            // Clear signature
            document.getElementById('clearSignatureBtn').addEventListener('click', function() {
                signaturePad.clear();
            });
            
            // Handle form submission
            document.getElementById('declarationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                if (signaturePad.isEmpty()) {
                    alert('Please provide your signature');
                    return;
                }
                saveDeclaration();
            });
            
            // Save declaration as PDF
            document.getElementById('saveDeclarationBtn').addEventListener('click', saveDeclaration);
            
            // Close modal buttons
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
        });

        function addInvoiceItem() {
            const itemsContainer = document.getElementById('invoiceItems');
            const newItem = document.createElement('div');
            newItem.className = 'form-row invoice-item';
            newItem.innerHTML = `
                <div class="form-group" style="flex: 3;">
                    <label>Description</label>
                    <input type="text" class="item-description" required>
                </div>
                <div class="form-group">
                    <label>Quantity</label>
                    <input type="number" class="item-quantity" min="1" value="1" required>
                </div>
                <div class="form-group">
                    <label>Price (₹)</label>
                    <input type="number" class="item-price" min="0" step="0.01" required>
                </div>
                <div class="form-group" style="align-self: flex-end;">
                    <button type="button" class="btn btn-danger btn-sm remove-item">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            itemsContainer.appendChild(newItem);
        }

        function previewInvoice() {
            const customerName = document.getElementById('invoiceCustomerName').value;
            const customerEmail = document.getElementById('invoiceCustomerEmail').value;
            const customerAddress = document.getElementById('invoiceCustomerAddress').value;
            const invoiceDate = document.getElementById('invoiceDate').value;
            const invoiceNumber = document.getElementById('invoiceNumber').value;
            const trackingNumber = document.getElementById('invoiceTrackingNumber').value;
            const notes = document.getElementById('invoiceNotes').value;
            const terms = document.getElementById('invoiceTerms').value;
            
            // Get items
            const items = [];
            let subtotal = 0;
            document.querySelectorAll('.invoice-item').forEach(item => {
                const description = item.querySelector('.item-description').value;
                const quantity = parseFloat(item.querySelector('.item-quantity').value);
                const price = parseFloat(item.querySelector('.item-price').value);
                const total = quantity * price;
                
                items.push({ description, quantity, price, total });
                subtotal += total;
            });
            
            // Calculate tax (18% GST)
            const taxRate = 0.18;
            const tax = subtotal * taxRate;
            const total = subtotal + tax;
            
            // Format date
            const formattedDate = new Date(invoiceDate).toLocaleDateString('en-IN', {
                year: 'numeric', month: 'short', day: 'numeric'
            });
            
            // Generate invoice HTML
            const invoiceHTML = `
                <div style="font-family: 'Poppins', sans-serif; max-width: 800px; margin: 0 auto;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 30px;">
                        <div>
                            <h1 style="color: #2c3e50; margin-bottom: 5px;">Shrestha International Couriers</h1>
                            <p style="margin: 0; color: #7f8c8d;">7/4, Sali Pet, Arundelpet, Guntur, Andhra Pradesh 522002</p>
                            <p style="margin: 0; color: #7f8c8d;">+91 94939 24742 | srasthainternationalcouriers@gmail.com</p>
                        </div>
                        <div style="text-align: right;">
                            <h2 style="color: #2c3e50; margin-bottom: 5px;">INVOICE</h2>
                            <p style="margin: 0; color: #7f8c8d;">#${invoiceNumber}</p>
                            <p style="margin: 0; color: #7f8c8d;">Date: ${formattedDate}</p>
                            <p style="margin: 0; color: #7f8c8d;">Tracking: ${trackingNumber}</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <div style="flex: 1;">
                            <h3 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px;">Bill To</h3>
                            <p style="margin: 5px 0; font-weight: 500;">${customerName}</p>
                            <p style="margin: 5px 0; color: #7f8c8d;">${customerEmail}</p>
                            <p style="margin: 5px 0; color: #7f8c8d;">${customerAddress.replace(/\n/g, '<br>')}</p>
                        </div>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                        <thead>
                            <tr style="background-color: #2c3e50; color: white;">
                                <th style="padding: 10px; text-align: left;">Description</th>
                                <th style="padding: 10px; text-align: right;">Qty</th>
                                <th style="padding: 10px; text-align: right;">Price</th>
                                <th style="padding: 10px; text-align: right;">Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${items.map(item => `
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #ddd;">${item.description}</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${item.quantity}</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">₹${item.price.toFixed(2)}</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">₹${item.total.toFixed(2)}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div style="margin-left: auto; width: 300px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 500;">Subtotal:</span>
                            <span>₹${subtotal.toFixed(2)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 500;">GST (18%):</span>
                            <span>₹${tax.toFixed(2)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 1.2em; font-weight: 700; border-top: 1px solid #ddd; padding-top: 10px; margin-top: 10px;">
                            <span>Total:</span>
                            <span>₹${total.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    ${notes ? `
                        <div style="margin-top: 30px;">
                            <h3 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px;">Notes</h3>
                            <p>${notes.replace(/\n/g, '<br>')}</p>
                        </div>
                    ` : ''}
                    
                    <div style="margin-top: 30px;">
                        <h3 style="color: #2c3e50; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px;">Terms & Conditions</h3>
                        <p>${terms.replace(/\n/g, '<br>')}</p>
                    </div>
                    
                    <div style="margin-top: 50px; display: flex; justify-content: space-between;">
                        <div>
                            <p style="border-top: 1px solid #2c3e50; padding-top: 10px; width: 200px; text-align: center;">
                                Customer Signature
                            </p>
                        </div>
                        <div>
                            <p style="border-top: 1px solid #2c3e50; padding-top: 10px; width: 200px; text-align: center;">
                                For Shrestha International Couriers
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            // Show preview
            document.getElementById('printableArea').innerHTML = invoiceHTML;
            document.getElementById('invoicePreviewModal').style.display = 'flex';
        }

        function printInvoice() {
            const printContent = document.getElementById('printableArea').innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
            location.reload();
        }

        function downloadInvoice() {
            const element = document.getElementById('printableArea');
            const opt = {
                margin: 10,
                filename: `invoice_${document.getElementById('invoiceNumber').value}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            html2pdf().set(opt).from(element).save();
        }

        function saveDeclaration() {
            const name = document.getElementById('declarationName').value;
            const email = document.getElementById('declarationEmail').value;
            const phone = document.getElementById('declarationPhone').value;
            const idNumber = document.getElementById('declarationIdNumber').value;
            const address = document.getElementById('declarationAddress').value;
            const content = document.getElementById('declarationContent').value;
            const value = document.getElementById('declarationValue').value;
            const signature = document.getElementById('signaturePad').toDataURL();
            
            const today = new Date().toLocaleDateString('en-IN', {
                year: 'numeric', month: 'long', day: 'numeric'
            });
            
            const declarationHTML = `
                <div id="printableArea" style="font-family: 'Poppins', sans-serif; max-width: 800px; margin: 0 auto; padding: 20px;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h1 style="color: #2c3e50;">Shrestha International Couriers</h1>
                        <h2 style="color: #2c3e50;">Document/Content Declaration</h2>
                        <p style="color: #7f8c8d;">7/4, Sali Pet, Arundelpet, Guntur, Andhra Pradesh 522002</p>
                        <p style="color: #7f8c8d;">+91 94939 24742 | srasthainternationalcouriers@gmail.com</p>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <p>I, <strong>${name}</strong>, hereby declare that the following information is true and correct to the best of my knowledge:</p>
                        
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                            <tr>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd; width: 30%;">Email:</td>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${email}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Phone Number:</td>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${phone}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">ID Number:</td>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${idNumber}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Address:</td>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${address.replace(/\n/g, '<br>')}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Content Description:</td>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${content.replace(/\n/g, '<br>')}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Declared Value:</td>
                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">₹${parseFloat(value).toFixed(2)}</td>
                            </tr>
                        </table>
                        
                        <p>I understand that providing false information may result in legal consequences and that Shrestha International Couriers is not responsible for any undeclared items.</p>
                        
                        <div style="margin-top: 40px; display: flex; justify-content: space-between;">
                            <div style="width: 45%;">
                                <p>Date: ${today}</p>
                                <p>Place: Guntur, Andhra Pradesh</p>
                            </div>
                            <div style="width: 45%; text-align: center;">
                                <p>Signature:</p>
                                <img src="${signature}" style="max-width: 200px; max-height: 80px; margin-top: 10px;">
                                <p style="margin-top: 5px;">${name}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="border-top: 1px solid #ddd; padding-top: 20px; margin-top: 40px;">
                        <h3 style="color: #2c3e50;">For Office Use Only</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd; width: 30%;">Received By:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;"></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">Date Received:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;"></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">Tracking Number:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;"></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">Remarks:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            `;
            
            // Create a new window with the declaration
            const win = window.open('', '_blank');
            win.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Document Declaration - ${name}</title>
                    <style>
                        body { font-family: 'Poppins', sans-serif; }
                        @media print {
                            body { padding: 20px; }
                            .no-print { display: none !important; }
                        }
                    </style>
                </head>
                <body>
                    ${declarationHTML}
                    <div style="text-align: center; margin-top: 20px;" class="no-print">
                        <button onclick="window.print()" style="padding: 10px 20px; background: #2c3e50; color: white; border: none; cursor: pointer;">
                            Print Declaration
                        </button>
                        <button onclick="saveAsPDF()" style="padding: 10px 20px; background: #e74c3c; color: white; border: none; cursor: pointer; margin-left: 10px;">
                            Save as PDF
                        </button>
                    </div>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
                    <script>
                        function saveAsPDF() {
                            const element = document.getElementById('printableArea');
                            const opt = {
                                margin: 10,
                                filename: 'declaration_${name.replace(/\s+/g, '_')}_${new Date().toISOString().slice(0, 10)}.pdf',
                                image: { type: 'jpeg', quality: 0.98 },
                                html2canvas: { scale: 2 },
                                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                            };
                            html2pdf().set(opt).from(element).save();
                        }
                    </script>
                </body>
                </html>
            `);
            win.document.close();
        }
    </script>
</body>
</html>
